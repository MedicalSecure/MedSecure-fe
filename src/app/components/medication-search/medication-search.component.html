<div class="d-flex justify-content-center">
  <div class="d-flex flex-column gap-5">
    <div class="search-field position-relative mt-1">
      <input
        type="text"
        placeholder="Search for medication"
        matInput
        [formControl]="searchControl"
        [matAutocomplete]="auto"
        class="form-control custom-width-rem custom-height custom-border-style custom-padding-right"
        (keypress)="handleKeyPress($event)"
      />
      <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
        <ng-container *ngFor="let medication of filteredMedications | async">
          <mat-option
            (click)="openDialog(medication)"
            [value]="medication"
            class="result"
          >
            {{ getMedicationProperty(medication) }}
          </mat-option>
        </ng-container>
      </mat-autocomplete>
      <button
        mat-icon-button
        matSuffix
        class="position-absolute top-50 bg-transparent"
        style="right: 5px; transform: translateY(-41%); border: none"
      >
        <mat-icon>search</mat-icon>
      </button>
    </div>

    <div>
      <div class="mat-chip-listbox-container d-flex gap-3 mt-3">
        <strong
          ><p style="font-size: x-large; margin-top: 7px">
            Je cherche par:
          </p></strong
        >
        <mat-chip-listbox
          [value]="searchKey"
          (change)="onSelectionChange($event)"
        >
          <mat-chip-option value="Nom">Name</mat-chip-option>
          <mat-chip-option value="Laboratoire">Pathologie</mat-chip-option>
          <mat-chip-option value="Indications">SubstanceActive</mat-chip-option>
        </mat-chip-listbox>
      </div>

      <div class="mat-chip-listbox-container d-flex mt-5 gap-3">
        <strong
          ><p style="font-size: x-large; margin-top: 7px">
            Je cherche par:
          </p></strong
        >
        <mat-chip-listbox
          [value]="searchKey"
          (change)="onSelectionChange($event)"
        >
          <mat-chip-option value="pn">Patient Name</mat-chip-option>
          <mat-chip-option value="dn">DN</mat-chip-option>
          <mat-chip-option value="pid">Patiend ID</mat-chip-option>
          <mat-chip-option value="rd">Registration Date</mat-chip-option>
          <mat-chip-option value="cin">CIN</mat-chip-option>
        </mat-chip-listbox>
      </div>
    </div>

    <div *ngIf="selectedMedications.length > 0" class="mt-3 mb-5">
      <h3>Selected Medicines:</h3>
      <div
        *ngFor="let medication of selectedMedications"
        class="medication-item mb-3"
      >
        <p class="text-primary mb-0 gap-3 mt-4" style="display: flex">
          <mat-icon style="margin-right: 5px">medical_services</mat-icon>
          <strong style="margin-right: 5px"></strong>
          <mark
            ><strong>{{ medication["Nom"] }}</strong></mark
          >
          <strong style="margin-right: 5px"></strong>
          <mark
            ><strong>{{ medication["Dosage"] }}</strong></mark
          >
          <strong style="margin-right: 100px"></strong>
          <mark
            ><strong>{{ medication["Quantity"] }}</strong></mark
          >
          <img
            src="assets/images/info.svg"
            alt="info"
            class="image"
            style="height: 15px; width: 15px; margin-top: 5px; margin-left: 5px"
            matTooltip="
            Indications: {{ medication['Indications'] }}
            "
          />
        </p>
      </div>
    </div>
  </div>
</div>
