<div class="table-responsive mt-1">
  <table mat-table class="table extended-table" >
    <thead>
      <tr>
        <th scope="col"></th>
        <ng-container *ngFor="let hour of targetHours; let i = index">
            <th scope="col" style="width: 25% ;" [ngStyle]="{'background-color': isCurrentHour(hour) ? '#fef6d5' : '#f2f2f2'}" >{{ hour }} H</th>
          </ng-container>
      </tr>
    </thead>
    <tbody>
      @for (room of uniqueroom; track room) {
      <tr>
        <th >
          <h6 class="my-0" style="font-size: smaller;">Room</h6> {{ room }}
        </th>
        <td [ngStyle]="{'background-color': isCurrentHour(targetHours[0]) ? '#fef6d5' : '#f2f2f2'}">
          @for (element of data_list; track element) { @if (element.room.number ===
          room) { @for (medicine of
          getMedicineByHour(targetHours[0],element.patient.name); track medicine) {
          @for (posology of medicine.posology; track posology) {
          <ul class="list-group mb-3 sticky-top">
            <li
              class="list-group-item d-flex justify-content-between lh-condensed"
            >
              <div>
                <h6 class="my-0" style="font-size: smaller;">Patient</h6>
                <small class="text-muted">{{ element.patient.name }}</small>
              </div>
              <div>
                <h6 class="my-0" style="font-size: smaller;">Bed</h6>
                <small class="text-muted">{{ element.bed }}</small>
              </div>
              <div>
                <h6 class="my-0" style="font-size: smaller;">Medication</h6>
                <small class="text-muted">{{ medicine.name }}</small>
              </div>
              <div>
                <h6 class="my-0" style="font-size: smaller;">Quantity</h6>
                <small class="text-muted">{{
                  calculateQuantity(
                    posology.quantityBE,
                    posology.quantityAE
                  )
                }}</small>
              </div>
            </li>
          </ul>
          }} } }
        </td>
        
        <td [ngStyle]="{'background-color': isCurrentHour(targetHours[1]) ? '#fef6d5' : '#f2f2f2'}">
            @for (element of data_list; track element) {
              @if (element.room.number === room) {
                @for (medicine of getMedicineByHour(targetHours[1], element.patient.name); track medicine) {
                  @for (posology of medicine.posology; track posology) {
                    <ul class="list-group mb-3">
                      <li class="list-group-item d-flex justify-content-between lh-condensed">
                        <div>
                          <h6 class="my-0" style="font-size: smaller;">Name</h6>
                          <small class="text-muted">{{ element.patient.name }}</small>
                        </div>
                        <div>
                          <h6 class="my-0" style="font-size: smaller;">Bed</h6>
                          <small class="text-muted">{{ element.bed }}</small>
                        </div>
                        <div>
                          <h6 class="my-0" style="font-size: smaller;">Medication</h6>
                          <small class="text-muted">{{ medicine.name }}</small>
                        </div>
                        <div>
                          <h6 class="my-0" style="font-size: smaller;">Quantity</h6>
                          <small class="text-muted">{{
                            calculateQuantity(
                              posology.quantityBE,
                              posology.quantityAE
                            )
                          }}</small>
                        </div>
                      </li>
                    </ul>
                  }
                }
              }
            }
        </td>
          
        <td [ngStyle]="{'background-color': isCurrentHour(targetHours[2]) ? '#fef6d5' : '#f2f2f2'}">
            @for (element of data_list; track element) {
              @if (element.room.number === room) {
                @for (medicine of getMedicineByHour(targetHours[2], element.patient.name); track medicine) {
                  @for (posology of medicine.posology; track posology) {
                    <ul class="list-group mb-3">
                      <li class="list-group-item d-flex justify-content-between lh-condensed">
                        <div>
                          <h6 class="my-0" style="font-size: smaller;">Name</h6>
                          <small class="text-muted">{{ element.patient.name }}</small>
                        </div>
                        <div>
                          <h6 class="my-0" style="font-size: smaller;">Bed</h6>
                          <small class="text-muted">{{ element.bed }}</small>
                        </div>
                        <div>
                          <h6 class="my-0" style="font-size: smaller;">Medication</h6>
                          <small class="text-muted">{{ medicine.name }}</small>
                        </div>
                        <div>
                          <h6 class="my-0" style="font-size: smaller;">Quantity</h6>
                          <small class="text-muted">{{
                            calculateQuantity(
                              posology.quantityBE,
                              posology.quantityAE
                            )
                          }}</small>
                        </div>
                      </li>
                    </ul>
                  }
                }
              }
            }
        </td>
          
        <td [ngStyle]="{'background-color': isCurrentHour(targetHours[3]) ? '#fef6d5' : '#f2f2f2'}">
            @for (element of data_list; track element) {
              @if (element.room.number === room) {
                @for (medicine of getMedicineByHour(targetHours[3], element.patient.name); track medicine) {
                  @for (posology of medicine.posology; track posology) {
                    <ul class="list-group mb-3">
                      <li class="list-group-item d-flex justify-content-between lh-condensed">
                        <div>
                          <h6 class="my-0" style="font-size: smaller;">Name</h6>
                          <small class="text-muted">{{ element.patient.name }}</small>
                        </div>
                        <div>
                          <h6 class="my-0" style="font-size: smaller;">Bed</h6>
                          <small class="text-muted">{{ element.bed}}</small>
                        </div>
                        <div>
                          <h6 class="my-0" style="font-size: smaller;">Medication</h6>
                          <small class="text-muted">{{ medicine.name }}</small>
                        </div>
                        <div>
                          <h6 class="my-0" style="font-size: smaller;">Quantity</h6>
                          <small class="text-muted">{{
                            calculateQuantity(
                              posology.quantityBE,
                              posology.quantityAE
                            )
                          }}</small>
                        </div>
                      </li>
                    </ul>
                  }
                }
              }
            }
        </td>
      </tr>
      }
    </tbody>
  </table>
</div>